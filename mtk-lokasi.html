<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Latihan Denah & Koordinat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap');
        
        body { font-family: 'Nunito', sans-serif; background-color: #f0f9ff; }

        /* SVG Styles */
        svg { display: block; margin: 0 auto; max-width: 100%; height: auto; user-select: none; }
        .grid-line { stroke: #e2e8f0; stroke-width: 1.5; }
        .axis-text { font-size: 14px; font-weight: bold; fill: #64748b; text-anchor: middle; dominant-baseline: middle; }
        .marker-text { font-size: 24px; text-anchor: middle; dominant-baseline: middle; }
        .label-text { font-size: 11px; font-weight: 700; fill: #334155; text-anchor: middle; }
        
        /* Card Styles */
        .option-card {
            transition: all 0.2s;
            border: 2px solid #cbd5e1;
            background-color: white;
            cursor: pointer;
        }
        .option-card:hover { border-color: #3b82f6; background-color: #eff6ff; }
        .option-input:checked + .option-card {
            background-color: #dbeafe;
            border-color: #2563eb;
            color: #1e40af;
            box-shadow: 0 0 0 2px #2563eb;
        }

        /* Animasi */
        @keyframes popIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .question-card { animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    </style>
</head>
<body class="pb-32 text-slate-800">

    <header class="bg-sky-600 text-white p-6 shadow-lg sticky top-0 z-40 border-b-4 border-sky-800">
        <div class="max-w-4xl mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-2xl font-extrabold tracking-tight">Latihan Denah & Koordinat</h1>
                <p class="text-sky-100 text-sm">Baca peta dan tentukan posisinya!</p>
            </div>
            <div class="bg-sky-800/50 backdrop-blur-sm px-4 py-2 rounded-xl text-sm font-bold border border-sky-400">
                Soal <span id="progress-text">0</span> / 15
            </div>
        </div>
    </header>

    <div id="quiz-container" class="max-w-3xl mx-auto space-y-8 px-4 mt-8"></div>

    <div class="fixed bottom-0 left-0 right-0 bg-white border-t border-slate-200 p-4 shadow-[0_-4px_20px_rgba(0,0,0,0.1)] z-50">
        <div class="max-w-3xl mx-auto flex justify-end">
            <button onclick="checkAnswers()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition active:scale-95 flex items-center gap-2 text-lg">
                <span>Cek Nilai</span>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </button>
        </div>
    </div>

    <div id="result-modal" class="fixed inset-0 bg-slate-900/70 hidden flex items-center justify-center z-[60] p-4 backdrop-blur-sm">
        <div class="bg-white rounded-3xl p-8 max-w-md w-full text-center shadow-2xl transform scale-100 transition-all">
            <div class="text-7xl mb-4">üó∫Ô∏è</div>
            <h2 class="text-3xl font-bold text-slate-800 mb-2">Hasil Kamu</h2>
            <div class="text-6xl font-black text-sky-600 mb-6" id="score-value">0</div>
            <p id="score-message" class="text-slate-600 mb-8 bg-slate-50 p-4 rounded-2xl text-sm font-medium border border-slate-100"></p>
            <button onclick="closeModal()" class="w-full bg-slate-800 hover:bg-slate-900 text-white py-4 rounded-2xl font-bold transition-colors">
                Lihat Pembahasan
            </button>
        </div>
    </div>

<script>
    // Konfigurasi Grid & Data Soal
    const COLS = ['A','B','C','D','E','F','G','H'];
    const ROWS = ['1','2','3','4','5','6','7','8']; // Row 1 di atas (Map style) atau Cartesian logic

    const qData = [
        {
            id: 1,
            text: "Adit menunjukkan letak tempat berliburnya pada peta. Tempat liburan Adit (üìç) terletak pada petak...",
            grid: { w: 4, h: 3, markers: [{c:2, r:1, icon:'üìç', label:'Adit'}] }, // C2 (0-based: c2=C, r1=2 assuming 1-based labels)
            // Let's standardise: c0=A, r0=1. So c2=C, r1=2.
            options: ["B1", "B2", "C1", "C2"],
            correct: 3, // C2
            explanation: "Lihat sumbu mendatar (huruf) = C, sumbu tegak (angka) = 2. Posisi (C, 2)."
        },
        {
            id: 2,
            text: "Sri berasal dari Kota Singaraja (üè†). Pada peta, daerah asalnya terletak pada petak...",
            grid: { w: 5, h: 6, markers: [{c:3, r:3, icon:'üè†', label:'Singaraja'}] }, // D4
            options: ["C4", "C5", "D4", "D5"],
            correct: 2, // D4
            explanation: "Luruskan ke atas ketemu huruf D, luruskan ke kiri ketemu angka 4. Jadi (D, 4)."
        },
        {
            id: 3,
            text: "Tanda ‚ùå pada gambar di bawah terletak pada koordinat...",
            grid: { w: 7, h: 5, markers: [{c:4, r:2, icon:'‚ùå'}] }, // E3
            options: ["(E,3)", "(E,4)", "(F,3)", "(F,4)"],
            correct: 0,
            explanation: "Huruf E dan Angka 3 bertemu di titik ‚ùå."
        },
        {
            id: 4,
            text: "Tanda ‚≠ï pada gambar di bawah terletak pada koordinat...",
            grid: { w: 4, h: 3, markers: [{c:2, r:1, icon:'‚≠ï'}] }, // C2
            options: ["(B,1)", "(B,2)", "(C,1)", "(C,2)"],
            correct: 3,
            explanation: "Koordinat ditulis (Sumbu Datar, Sumbu Tegak) = (C, 2)."
        },
        {
            id: 5,
            text: "Letak beruang (üêª) pada gambar di bawah yaitu...",
            grid: { w: 4, h: 6, markers: [{c:2, r:3, icon:'üêª'}] }, // C4
            options: ["(B,4)", "(B,5)", "(C,4)", "(C,5)"],
            correct: 2,
            explanation: "Beruang ada di kolom C dan baris 4."
        },
        {
            id: 6,
            text: "Pada gambar di bawah, ayam (üêî) terletak pada...",
            grid: { w: 7, h: 7, markers: [{c:5, r:4, icon:'üêî'}] }, // F5
            options: ["(E,5)", "(E,6)", "(F,5)", "(F,6)"],
            correct: 2,
            explanation: "Tarik garis ke bawah = F, tarik garis ke samping = 5."
        },
        {
            id: 7,
            text: "Anak laki-laki (üë¶) pada gambar di bawah terletak pada...",
            grid: { w: 8, h: 7, markers: [{c:6, r:4, icon:'üë¶'}] }, // G5
            options: ["(H,5)", "(H,6)", "(G,5)", "(G,6)"],
            correct: 2,
            explanation: "Posisi anak berada di pertemuan kolom G dan baris 5."
        },
        {
            id: 8,
            text: "Bangun tabung (üõ¢Ô∏è) pada gambar di bawah terletak pada...",
            // Special case: Options use 0 and 1. Let's define custom labels for this grid.
            grid: { w: 3, h: 3, customCols:['A','B','C'], customRows:['0','1','2'], markers: [{c:0, r:1, icon:'üõ¢Ô∏è'}] }, // A1
            options: ["(A,0)", "(A,1)", "(B,0)", "(B,1)"],
            correct: 1,
            explanation: "Sumbu datar A, sumbu tegak 1. Jadi (A, 1)."
        },
        {
            id: 9,
            text: "Jarak dari titik P ke titik Q yaitu...",
            grid: { w: 6, h: 5, markers: [{c:1, r:1, icon:'P'}, {c:4, r:3, icon:'Q'}], path:[{c1:1,r1:1,c2:4,r2:1}, {c1:4,r1:1,c2:4,r2:3}] }, 
            // P(B,2) to Q(E,4). Delta: +3 Col (Kanan), +2 Row (Bawah).
            // Grid Logic: c1->c4 = 3 steps right. r1->r3 = 2 steps down.
            options: ["2 petak kanan, 2 bawah", "3 petak kanan, 2 bawah", "2 petak kanan, 2 atas", "3 petak kanan, 2 atas"],
            correct: 1,
            explanation: "Dari P ke Q: Melangkah 3 kotak ke kanan, lalu 2 kotak ke bawah."
        },
        {
            id: 10,
            text: "Jarak titik A ke titik B yaitu...",
            grid: { w: 5, h: 5, markers: [{c:2, r:4, icon:'A'}, {c:2, r:1, icon:'B'}], path:[{c1:2,r1:4,c2:2,r2:1}] },
            // A(C,5) -> B(C,2). Delta: -3 Row (Up).
            options: ["3 petak ke atas", "3 petak ke bawah", "4 petak ke kanan", "4 petak ke kiri"],
            correct: 0,
            explanation: "Posisi A di bawah, B di atas. Dari A naik 3 kotak menuju B."
        },
        {
            id: 11,
            text: "Jarak titik Yuri (Y) ke titik Ririn (R) yaitu...",
            grid: { w: 6, h: 6, markers: [{c:1, r:4, icon:'Y'}, {c:4, r:1, icon:'R'}] },
            // Y(B,5) -> R(E,2). Delta: +3 Right, -3 Up.
            options: ["2 kanan, 2 bawah", "2 kanan, 2 atas", "3 kanan, 3 bawah", "3 kanan, 3 atas"],
            correct: 3,
            explanation: "Yuri di kiri bawah, Ririn di kanan atas. 3 langkah kanan, 3 langkah atas."
        },
        {
            id: 12,
            text: "Jarak Balok (üì¶) ke titik Tabung (üõ¢Ô∏è) yaitu...",
            grid: { w: 6, h: 5, markers: [{c:4, r:3, icon:'üì¶'}, {c:0, r:1, icon:'üõ¢Ô∏è'}] },
            // Balok(E,4) -> Tabung(A,2). Delta: -4 Left, -2 Up.
            options: ["3 kanan, 2 atas", "3 kiri, 2 atas", "4 kanan, 2 atas", "4 kiri, 2 atas"],
            correct: 3,
            explanation: "Dari Balok mundur ke kiri 4 langkah, lalu naik 2 langkah."
        },
        {
            id: 13,
            text: "Jarak dari (A,7) ke (D,3) yaitu...",
            grid: { w: 5, h: 8, markers: [{c:0, r:6, label:'Start'}, {c:3, r:2, label:'End'}] }, // r6=7, r2=3
            // A->D (+3 Right), 7->3 (Up 4).
            options: ["3 kanan, 4 bawah", "3 kanan, 4 atas", "3 kanan, 5 bawah", "3 kanan, 5 atas"],
            correct: 1,
            explanation: "Huruf A ke D = 3 langkah kanan. Angka 7 ke 3 = 4 langkah naik (atas)."
        },
        {
            id: 14,
            text: "Rina duduk di (C,5). Hendra duduk: 2 deret di kanan Rina, baris persis di BELAKANG Rina. (Baris depan = 1). Posisi Hendra...",
            // Rina(C,5). Kanan +2 = E. Belakang = Row Number Bertambah (+1) = 6.
            grid: { w: 6, h: 7, markers: [{c:2, r:4, icon:'üë©', label:'Rina'}, {c:4, r:5, icon:'‚ùì'}] },
            options: ["(E,4)", "(E,6)", "(F,4)", "(F,6)"],
            correct: 1,
            explanation: "Kanan 2 dari C = E. Belakang baris 5 adalah baris 6 (makin besar makin belakang). Jadi (E, 6)."
        },
        {
            id: 15,
            text: "Linda di (D,3). Adit duduk: 4 deret kanan Linda, baris persis di DEPAN Linda. Posisi Adit...",
            // Linda(D,3). Kanan +4 = H. Depan = Row -1 = 2.
            grid: { w: 8, h: 5, markers: [{c:3, r:2, icon:'üëß', label:'Linda'}, {c:7, r:1, icon:'‚ùì'}] },
            options: ["(G,2)", "(G,4)", "(H,2)", "(H,4)"],
            correct: 2,
            explanation: "Kanan 4 dari D = H. Depan baris 3 adalah baris 2. Jadi (H, 2)."
        }
    ];

    // SVG Generator Function
    function generateGridSVG(params) {
        const size = 40; // Cell size
        const padL = 40, padT = 30, padR = 20, padB = 20;
        const w = params.w * size + padL + padR;
        const h = params.h * size + padT + padB;
        
        const cols = params.customCols || COLS;
        const rows = params.customRows || ROWS;

        let svg = `<svg viewBox="0 0 ${w} ${h}" width="${Math.min(w, 500)}">`;
        
        // Background
        svg += `<rect x="${padL}" y="${padT}" width="${params.w * size}" height="${params.h * size}" fill="white" stroke="#cbd5e1" stroke-width="2"/>`;

        // Grid Lines
        for (let i = 0; i <= params.w; i++) {
            const x = padL + i * size;
            svg += `<line x1="${x}" y1="${padT}" x2="${x}" y2="${h-padB}" class="grid-line" />`;
            if (i < params.w) {
                // Column Labels (Top)
                svg += `<text x="${x + size/2}" y="${padT - 10}" class="axis-text">${cols[i]}</text>`;
            }
        }
        for (let i = 0; i <= params.h; i++) {
            const y = padT + i * size;
            svg += `<line x1="${padL}" y1="${y}" x2="${w-padR}" y2="${y}" class="grid-line" />`;
            if (i < params.h) {
                // Row Labels (Left)
                svg += `<text x="${padL - 15}" y="${y + size/2}" class="axis-text">${rows[i]}</text>`;
            }
        }

        // Path (Jarak)
        if (params.path) {
            params.path.forEach(p => {
                const x1 = padL + p.c1 * size + size/2;
                const y1 = padT + p.r1 * size + size/2;
                const x2 = padL + p.c2 * size + size/2;
                const y2 = padT + p.r2 * size + size/2;
                svg += `<line x1="${x1}" y1="${y1}" x2="${x2}" y2="${y2}" stroke="#ef4444" stroke-width="3" stroke-dasharray="5,5" />`;
                svg += `<circle cx="${x2}" cy="${y2}" r="4" fill="#ef4444" />`;
            });
        }

        // Markers
        if (params.markers) {
            params.markers.forEach(m => {
                const x = padL + m.c * size + size/2;
                const y = padT + m.r * size + size/2;
                if (m.icon) {
                    svg += `<text x="${x}" y="${y+2}" class="marker-text">${m.icon}</text>`;
                } else if (m.label === 'Start' || m.label === 'End') {
                    svg += `<circle cx="${x}" cy="${y}" r="6" fill="${m.label==='Start'?'#3b82f6':'#ef4444'}" />`;
                }
                if (m.label && m.label !== 'Start' && m.label !== 'End') {
                    svg += `<text x="${x}" y="${y + size/2 + 12}" class="label-text">${m.label}</text>`;
                }
            });
        }

        svg += `</svg>`;
        return svg;
    }

    // Render Quiz
    const container = document.getElementById('quiz-container');
    const progressText = document.getElementById('progress-text');

    qData.forEach((q, idx) => {
        let optionsHTML = '';
        q.options.forEach((opt, i) => {
            optionsHTML += `
            <label class="relative w-full">
                <input type="radio" name="q${q.id}" value="${i}" class="option-input hidden">
                <div class="option-card p-4 rounded-xl text-center font-bold text-slate-600 shadow-sm">
                    ${opt}
                </div>
            </label>`;
        });

        container.innerHTML += `
        <div class="bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden question-card relative" id="card-${q.id}">
            <div class="bg-slate-50 px-6 py-3 border-b border-slate-100 flex justify-between items-center">
                <span class="text-xs font-black tracking-widest text-slate-400 uppercase">Soal ${idx + 1}</span>
                <span id="status-${q.id}" class="hidden text-xs font-bold px-2 py-1 rounded-md"></span>
            </div>
            <div class="p-6">
                <p class="text-lg font-medium text-slate-700 mb-6 leading-relaxed">${q.text}</p>
                
                <div class="mb-8 flex justify-center bg-slate-50/50 rounded-2xl border border-slate-100 py-6 overflow-x-auto">
                    ${generateGridSVG(q.grid)}
                </div>

                <div class="grid grid-cols-2 gap-3">
                    ${optionsHTML}
                </div>

                <div id="explanation-${q.id}" class="hidden mt-6 bg-sky-50 border-l-4 border-sky-400 p-4 rounded-r-lg text-sm text-slate-700">
                    <strong class="block text-sky-700 mb-1">Pembahasan:</strong>
                    ${q.explanation}
                </div>
            </div>
        </div>`;
    });

    function checkAnswers() {
        let score = 0;
        let answered = 0;
        qData.forEach(q => {
            const selected = document.querySelector(`input[name="q${q.id}"]:checked`);
            const statusEl = document.getElementById(`status-${q.id}`);
            const card = document.getElementById(`card-${q.id}`);
            const exp = document.getElementById(`explanation-${q.id}`);
            
            if (selected) {
                answered++;
                const val = parseInt(selected.value);
                exp.classList.remove('hidden');
                statusEl.classList.remove('hidden');
                
                if (val === q.correct) {
                    score++;
                    statusEl.innerText = "BENAR";
                    statusEl.className = "text-xs font-bold px-2 py-1 rounded-md bg-green-100 text-green-600";
                    card.classList.add('ring-2', 'ring-green-400');
                } else {
                    statusEl.innerText = "SALAH";
                    statusEl.className = "text-xs font-bold px-2 py-1 rounded-md bg-red-100 text-red-600";
                    card.classList.add('ring-2', 'ring-red-400');
                }
            }
        });

        const finalScore = Math.round((score / qData.length) * 100);
        document.getElementById('score-value').innerText = finalScore;
        
        const msg = document.getElementById('score-message');
        if (finalScore === 100) msg.innerText = "Wow! Kemampuan navigasimu setara GPS canggih!";
        else if (finalScore >= 70) msg.innerText = "Hebat! Kamu sudah paham cara membaca peta.";
        else msg.innerText = "Tidak apa-apa, coba perhatikan baris dan kolomnya pelan-pelan.";

        document.getElementById('result-modal').classList.remove('hidden');
    }

    function closeModal() { document.getElementById('result-modal').classList.add('hidden'); }

    document.addEventListener('change', (e) => {
        if(e.target.matches('input[type="radio"]')) {
            const count = document.querySelectorAll('input[type="radio"]:checked').length;
            document.getElementById('progress-text').innerText = count;
        }
    });
</script>
</body>
</html>
